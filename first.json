{
  "_comment": "This is a comment",
  "builders": [
    {
      "type": "amazon-ebs",
      "region": "us-east-1",
      "source_ami": "ami-2d39803a",
      "instance_type": "t2.micro",
      "ssh_username": "ubuntu",
      "subnet_id": "subnet-29c04203",
      "security_group_id": "sg-439cbc3b",
      "associate_public_ip_address": "false",
      "ami_name": "jenkins-packer-ubuntu {{timestamp}}",
      "ami_description": "Packer-provisioned image from Jenkins (testing purposes only, for now)",
      "tags": {
        "OS_Version": "Ubuntu",
        "Release": "Latest",
        "Owner": "Neil Hunt"
      }
    }
  ],
  "provisioners": [
    {
        "type": "shell",
        "inline": [
            "sleep 30",
            "sudo apt-add-repository ppa:ansible/ansible -y",
            "sudo apt-get update && sudo apt-get install ansible -y",
            "mkdir -p /opt/ansible/roles-ubuntu/roles",
            "cd /opt/ansible/roles-ubuntu",
            "git clone https://github.com/awailly/cis-ubuntu-ansible.git roles/cis",
            "cat >>  playbook.yml << 'EOF'\n---\n  - hosts: all\n  roles:\n    - cis\nEOF"
        ]
    }
  ]
}